<template>
    <lightning-card title="Available Products" icon-name="standard:product">
        
        <!-- Filter Controls -->
        <div class="slds-grid slds-gutters slds-p-horizontal_medium slds-m-bottom_medium">
            
            <div class="slds-col">
                <lightning-combobox
                name="country"
                label="Country"
                value={selectedCountry}
                options={countryOptions}
                onchange={handleChange}>
            </lightning-combobox>
        </div>
        
        <div class="slds-col">
            <lightning-combobox
            name="type"
            label="Type"
            value={selectedType}
            options={recortTypeOptions}
            onchange={handleChange}>
        </lightning-combobox>
    </div>
    
    <div class="slds-col">
        <lightning-input
        label="Opportunity Name"
        value={opportunityName}
        onchange={handleNameChange}>
    </lightning-input>
</div>


</div>
<!-- Product Table -->

<template if:true={products}>
    <!-- Loading -->
    <template if:true={isLoading}>
        <div class="slds-align_absolute-center slds-m-top_medium">
            <lightning-spinner alternative-text="Loading products" size="medium"></lightning-spinner>
        </div>
    </template>
    
    <template if:true={products.length}>
        <lightning-datatable
            key-field="productId"
            onrowaction={handleRowAction}
            data={products}
            onrowselection={handleRowSelection}
            columns={columns}
            selected-rows={selectedRowIds}>

        </lightning-datatable>

        <!-- Pagination Controls -->
        <div class="slds-m-top_medium slds-align_absolute-center">
            <lightning-button label="Previous" onclick={previousPage} disabled={disablePrevious}></lightning-button>
            <span class="slds-m-horizontal_medium">Page {currentPage} of {totalPages}</span>
            <lightning-button label="Next" onclick={nextPage} disabled={disableNext}></lightning-button>
        </div>
    </template>
    <template if:false={products.length}>
        <p class="slds-text-color_weak slds-p-horizontal_medium">
            No products found.
        </p>
    </template>
  
</template>

<!-- Error Handling -->
<template if:true={error}>
    <p class="slds-text-color_error slds-p-horizontal_medium">
        {error.body.message}
    </p>
</template>

<div class="slds-m-top_medium slds-align_absolute-center">
    <lightning-button
    label="Submit"
    variant="brand"
    onclick={handleSubmit}>
</lightning-button>
</div>

</lightning-card>
</template>
